{"version":3,"sources":["components/SignIn/index.js","containers/Auth/Signin.js"],"names":["countries","require","default","FormItem","styled","Form","Item","_templateObject","Option","Select","WrappedSignIn","create","injectIntl","props","messages","intl","signIn","history","getFieldDecorator","form","formValues","_useState","useState","_useState2","Object","slicedToArray","loading","setLoading","_useState3","_useState4","visible","setVisible","success","response","accessToken","data","message","signin","auth","setToken","setAuthToken","resetFields","needBillingInformation","push","options","keys","map","key","react_default","a","createElement","value","name","className","style","backgroundImage","es_form","onSubmit","e","preventDefault","validateFields","err","values","email","password","then","catch","error","status","user","all","console","log","rules","type","required","input","size","prefix","icon","fontSize","placeholder","valuePropName","initialValue","es_checkbox","rememberMe","es_button","htmlType","btnSignInLoad","btnSignIn","react_router_dom","to","register","modal","title","onOk","_ref","asyncToGenerator","regenerator_default","mark","_callee","wrap","_context","prev","next","abrupt","continent","country","addBillingInfo","stop","_x","_x2","apply","this","arguments","clearAppStorage","onCancel","textAlign","profile","billinginformation","margin","address","hasFeedback","es_select","showSearch","optionFilterProp","filterOption","option","children","toLowerCase","indexOf","vattax","withRouter","connect","state","location","router","dispatch","authAct","bindActionCreators","authActions","fetchAuth","rc_queue_anim_es","src_components_SignIn"],"mappings":"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","file":"static/js/20.32e89dd5.chunk.js","sourcesContent":["import React, { useState } from 'react';\nimport { Form, Icon, Input, Button, Checkbox, message, Modal, Select } from 'antd';\nimport { Link, withRouter } from 'react-router-dom';\nimport { injectIntl } from 'react-intl';\nimport { signin, setAuthToken, addBillingInfo } from './../../services';\nimport styled from 'styled-components';\n\nimport auth from './../../utils/auth';\nimport './index.css';\n\nconst countries = require('./../../utils/countries').default;\n\nconst FormItem = styled(Form.Item)`\n  &.ant-form-inline .ant-form-item {\n    margin: 0 !important;\n  }\n`;\n\nconst Option = Select.Option;\n\nconst SignIn = props => {\n  const {\n    intl: { messages },\n    signIn,\n    history,\n    form: { getFieldDecorator },\n  } = props;\n  const formValues = {\n    name: '',\n    address: '',\n    country: 'ES',\n    vattax: '',\n  };\n  const [loading, setLoading] = useState(false);\n  const [visible, setVisible] = useState(false);\n\n  const handleReset = () => {\n    props.form.resetFields();\n  };\n\n  const success = response => {\n    const { accessToken } = response.data;\n\n    message.success(messages.signin.success);\n    auth.setToken(accessToken, true);\n    signIn(response.data);\n    setAuthToken(accessToken);\n    handleReset();\n    setLoading(false);\n\n    if (response.data && response.data.needBillingInformation) {\n      setVisible(true);\n    } else {\n      history.push('/dashboard');\n    }\n  };\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    props.form.validateFields(['email', 'password'], (err, values) => {\n      if (!err) {\n        const form = {\n          email: values.email,\n          password: values.password,\n        };\n        setLoading(true);\n\n        signin(form)\n          .then(response => {\n            success(response);\n          })\n          .catch(error => {\n            try {\n              if (error.response.status === 404) {\n                message.error(messages.signin.error.user);\n              } else if (error.response.status === 401) {\n                message.error(messages.signin.error.password);\n              } else {\n                message.error(messages.signin.error.all);\n              }\n            } catch (err) {\n              console.log(err);\n            }\n            setLoading(false);\n          });\n      }\n    });\n  };\n\n  const handleOk = e => {\n    console.log(e);\n    const { form, history } = props;\n    try {\n      form.validateFields(['name', 'address', 'country', 'vattax'], async (err, values) => {\n        if (err) {\n          return;\n        }\n        values.continent = countries[values.country].continent;\n        await addBillingInfo(values);\n        history.push('/dashboard');\n        setVisible(false);\n      });\n    } catch (error) {\n      auth.clearAppStorage();\n      history.push('/');\n      setVisible(false);\n    }\n  };\n\n  const handleCancel = e => {\n    console.log(e);\n    const { history } = props;\n    auth.clearAppStorage();\n    history.push('/');\n    setVisible(false);\n  };\n\n  const options = Object.keys(countries).map(key => {\n    return (\n      <Option key={key} value={key}>\n        {countries[key].name}\n      </Option>\n    );\n  });\n\n  return (\n    <section className=\"form-card row no-gutters\">\n      <div\n        className=\"form-card__img form-card__img--left col-lg-5\"\n        style={{\n          backgroundImage: \"url('../images/bruno-martins-442125-unsplash.jpg')\",\n        }}\n      ></div>\n      <div className=\"form-card__body col-lg-7 p-lg-6 p-4\">\n        <section className=\"form-v1-container\">\n          <h2>Login to Continue</h2>\n          <p className=\"lead\">\n            Welcome back, sign in with your <strong>Authenticity.ai</strong> account\n          </p>\n          <Form onSubmit={handleSubmit} className=\"form-v1\">\n            <FormItem>\n              {getFieldDecorator('email', {\n                rules: [\n                  {\n                    type: 'email',\n                    message: messages.signin.rules.email.type,\n                  },\n                  {\n                    required: true,\n                    message: messages.signin.rules.email.required,\n                  },\n                ],\n              })(\n                <Input\n                  size=\"large\"\n                  prefix={<Icon type=\"user\" style={{ fontSize: 13 }} />}\n                  placeholder=\"Email\"\n                />\n              )}\n            </FormItem>\n            <FormItem>\n              {getFieldDecorator('password', {\n                rules: [\n                  {\n                    required: true,\n                    message: messages.signin.rules.password.required,\n                  },\n                ],\n              })(\n                <Input\n                  size=\"large\"\n                  prefix={<Icon type=\"lock\" style={{ fontSize: 13 }} />}\n                  type=\"password\"\n                  placeholder={messages.signin.password}\n                />\n              )}\n            </FormItem>\n            <FormItem className=\"form-v1__remember\">\n              {getFieldDecorator('login1-remember', {\n                valuePropName: 'checked',\n                initialValue: true,\n              })(<Checkbox>{messages.signin.rememberMe}</Checkbox>)}\n            </FormItem>\n            <FormItem>\n              <Button\n                loading={loading}\n                type=\"primary\"\n                htmlType=\"submit\"\n                className=\"btn-cta btn-block\"\n              >\n                {!loading ? messages.signin.btnSignIn : messages.signin.btnSignInLoad}\n              </Button>\n            </FormItem>\n          </Form>\n          <p className=\"additional-info\">\n            Don't have an account yet? <Link to=\"/main/signup\">{messages.signin.register}</Link>\n          </p>\n          {/* <p className=\"additional-info\">\n            Forgot your username or password? <Link to=\"#\">Reset password</Link>\n          </p> */}\n        </section>\n      </div>\n      <Modal title=\"Basic Modal\" visible={visible} onOk={handleOk} onCancel={handleCancel}>\n        <h3 style={{ textAlign: 'center' }}>{messages.profile.billinginformation}</h3>\n        <Form style={{ margin: '0 auto' }} className=\"login-form\">\n          {/* nombre, dirección, pais, VAT/TAX number */}\n          <Form.Item>\n            {getFieldDecorator('name', {\n              initialValue: formValues.name,\n              rules: [\n                {\n                  required: true,\n                  message: 'Please input your Name!',\n                },\n              ],\n            })(<Input placeholder={messages.profile.name} />)}\n          </Form.Item>\n          <Form.Item>\n            {getFieldDecorator('address', {\n              initialValue: formValues.address,\n              rules: [\n                {\n                  required: true,\n                  message: 'Please input your Address!',\n                },\n              ],\n            })(<Input placeholder={messages.profile.address} />)}\n          </Form.Item>\n          <Form.Item hasFeedback>\n            {getFieldDecorator('country', {\n              initialValue: formValues.country,\n              rules: [\n                {\n                  required: true,\n                  message: 'Please select your country!',\n                },\n              ],\n            })(\n              <Select\n                showSearch\n                optionFilterProp=\"children\"\n                filterOption={(input, option) =>\n                  option.props.children.toLowerCase().indexOf(input.toLowerCase()) >= 0\n                }\n                placeholder={messages.profile.country}\n              >\n                {options}\n              </Select>\n            )}\n          </Form.Item>\n          <Form.Item>\n            {getFieldDecorator('vattax', {\n              initialValue: formValues.vattax,\n              rules: [\n                {\n                  required: true,\n                  message: 'Please input your VAT/TAX number!',\n                },\n              ],\n            })(<Input placeholder={messages.profile.vattax} />)}\n          </Form.Item>\n        </Form>\n      </Modal>\n    </section>\n  );\n};\n\nconst WrappedSignIn = Form.create()(injectIntl(SignIn));\n\nexport default withRouter(WrappedSignIn);\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport QueueAnim from 'rc-queue-anim';\nimport * as authActions from './../../reducers/auth';\n\nimport SignIn from './../../components/SignIn';\n\nconst Signin = props => {\n  const {\n    location,\n    authAct: { fetchAuth },\n  } = props;\n\n  const signIn = data => {\n    fetchAuth(data);\n  };\n\n  return (\n    <div className=\"container-fluid no-breadcrumb container-mw-lg chapter\">\n      <article className=\"article\">\n        <QueueAnim type=\"bottom\" className=\"ui-animate\">\n          <div className=\"mb-5\" key=\"1\">\n            {' '}\n            <SignIn signIn={signIn} location={location} />{' '}\n          </div>\n        </QueueAnim>\n      </article>\n    </div>\n  );\n};\n\nfunction mapStateToProps(state) {\n  return {\n    location: state.router.location,\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    authAct: bindActionCreators(authActions, dispatch),\n  };\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Signin);\n"],"sourceRoot":""}
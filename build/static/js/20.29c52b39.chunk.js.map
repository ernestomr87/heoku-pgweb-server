{"version":3,"sources":["components/SignIn/index.js","containers/Auth/Signin.js"],"names":["countries","require","default","FormItem","styled","Form","Item","_templateObject","Option","Select","WrappedSignIn","create","injectIntl","props","messages","intl","signIn","history","getFieldDecorator","form","formValues","_useState","useState","_useState2","Object","slicedToArray","loading","setLoading","_useState3","_useState4","visible","setVisible","success","response","accessToken","data","message","signin","auth","setToken","setAuthToken","resetFields","needBillingInformation","push","options","keys","map","key","react_default","a","createElement","value","name","className","style","backgroundImage","concat","process","config","pangeanic","title","es_form","onSubmit","e","preventDefault","validateFields","err","values","email","password","then","catch","error","status","user","all","rules","type","required","input","size","prefix","icon","fontSize","placeholder","valuePropName","initialValue","es_checkbox","rememberMe","es_button","htmlType","btnSignInLoad","btnSignIn","react_router_dom","to","register","modal","onOk","_ref","asyncToGenerator","regenerator_default","mark","_callee","wrap","_context","prev","next","abrupt","continent","country","addBillingInfo","stop","_x","_x2","apply","this","arguments","onCancel","clearAppStorage","textAlign","profile","billinginformation","margin","address","hasFeedback","es_select","showSearch","optionFilterProp","filterOption","option","children","toLowerCase","indexOf","vattax","withRouter","connect","state","location","router","dispatch","authAct","bindActionCreators","authActions","fetchAuth","rc_queue_anim_es","src_components_SignIn"],"mappings":"yfAWA,IAAMA,EAAYC,EAAQ,KAA2BC,QAE/CC,EAAWC,YAAOC,IAAKC,KAAZF,CAAHG,KAMRC,EAASC,IAAOD,OAuPhBE,EAAgBL,IAAKM,QAALN,CAAcO,YArPrB,SAAAC,GAAS,IAEZC,EAIND,EAJFE,KAAQD,SACRE,EAGEH,EAHFG,OACAC,EAEEJ,EAFFI,QACQC,EACNL,EADFM,KAAQD,kBAEJE,EACE,GADFA,EAEK,GAFLA,EAGK,KAHLA,EAII,GAXYC,EAaQC,oBAAS,GAbjBC,EAAAC,OAAAC,EAAA,EAAAD,CAAAH,EAAA,GAafK,EAbeH,EAAA,GAaNI,EAbMJ,EAAA,GAAAK,EAcQN,oBAAS,GAdjBO,EAAAL,OAAAC,EAAA,EAAAD,CAAAI,EAAA,GAcfE,EAdeD,EAAA,GAcNE,EAdMF,EAAA,GAoBhBG,EAAU,SAAAC,GAAY,IAClBC,EAAgBD,EAASE,KAAzBD,YAERE,IAAQJ,QAAQlB,EAASuB,OAAOL,SAChCM,IAAKC,SAASL,GAAa,GAC3BlB,EAAOiB,EAASE,MAChBK,aAAaN,GATbrB,EAAMM,KAAKsB,cAWXd,GAAW,GAEPM,EAASE,MAAQF,EAASE,KAAKO,uBACjCX,GAAW,GAEXd,EAAQ0B,KAAK,eA8DXC,EAAUpB,OAAOqB,KAAK7C,GAAW8C,IAAI,SAAAC,GACzC,OACEC,EAAAC,EAAAC,cAAC1C,EAAD,CAAQuC,IAAKA,EAAKI,MAAOJ,GACtB/C,EAAU+C,GAAKK,QAKtB,OACEJ,EAAAC,EAAAC,cAAA,WAASG,UAAU,4BACjBL,EAAAC,EAAAC,cAAA,OACEG,UAAU,+CACVC,MAAO,CACLC,gBAAe,QAAAC,OAAUC,GAAV,kDAGnBT,EAAAC,EAAAC,cAAA,OAAKG,UAAU,uCACbL,EAAAC,EAAAC,cAAA,WAASG,UAAU,qBACjBL,EAAAC,EAAAC,cAAA,+BACAF,EAAAC,EAAAC,cAAA,KAAGG,UAAU,QAAb,mCACkCL,EAAAC,EAAAC,cAAA,cAASQ,IAAOC,UAAUC,OAD5D,YAGAZ,EAAAC,EAAAC,cAACW,EAAA,EAAD,CAAMC,SAhFO,SAAAC,GACnBA,EAAEC,iBACFnD,EAAMM,KAAK8C,eAAe,CAAC,QAAS,YAAa,SAACC,EAAKC,GACrD,IAAKD,EAAK,CACR,IAAM/C,EAAO,CACXiD,MAAOD,EAAOC,MACdC,SAAUF,EAAOE,UAEnB1C,GAAW,GAEXU,aAAOlB,GACJmD,KAAK,SAAArC,GACJD,EAAQC,KAETsC,MAAM,SAAAC,GACL,IACgC,MAA1BA,EAAMvC,SAASwC,OACjBrC,IAAQoC,MAAM1D,EAASuB,OAAOmC,MAAME,MACD,MAA1BF,EAAMvC,SAASwC,OACxBrC,IAAQoC,MAAM1D,EAASuB,OAAOmC,MAAMH,UAEpCjC,IAAQoC,MAAM1D,EAASuB,OAAOmC,MAAMG,KAEtC,MAAOT,GACP9B,IAAQoC,MAAMN,EAAI9B,SAEpBT,GAAW,SAsDiB0B,UAAU,WACtCL,EAAAC,EAAAC,cAAC/C,EAAD,KACGe,EAAkB,QAAS,CAC1B0D,MAAO,CACL,CACEC,KAAM,QACNzC,QAAStB,EAASuB,OAAOuC,MAAMR,MAAMS,MAEvC,CACEC,UAAU,EACV1C,QAAStB,EAASuB,OAAOuC,MAAMR,MAAMU,YAR1C5D,CAYC8B,EAAAC,EAAAC,cAAC6B,EAAA,EAAD,CACEC,KAAK,QACLC,OAAQjC,EAAAC,EAAAC,cAACgC,EAAA,EAAD,CAAML,KAAK,OAAOvB,MAAO,CAAE6B,SAAU,MAC7CC,YAAY,YAIlBpC,EAAAC,EAAAC,cAAC/C,EAAD,KACGe,EAAkB,WAAY,CAC7B0D,MAAO,CACL,CACEE,UAAU,EACV1C,QAAStB,EAASuB,OAAOuC,MAAMP,SAASS,YAJ7C5D,CAQC8B,EAAAC,EAAAC,cAAC6B,EAAA,EAAD,CACEC,KAAK,QACLC,OAAQjC,EAAAC,EAAAC,cAACgC,EAAA,EAAD,CAAML,KAAK,OAAOvB,MAAO,CAAE6B,SAAU,MAC7CN,KAAK,WACLO,YAAatE,EAASuB,OAAOgC,aAInCrB,EAAAC,EAAAC,cAAC/C,EAAD,CAAUkD,UAAU,qBACjBnC,EAAkB,kBAAmB,CACpCmE,cAAe,UACfC,cAAc,GAFfpE,CAGE8B,EAAAC,EAAAC,cAACqC,EAAA,EAAD,KAAWzE,EAASuB,OAAOmD,cAEhCxC,EAAAC,EAAAC,cAAC/C,EAAD,KACE6C,EAAAC,EAAAC,cAACuC,EAAA,EAAD,CACE/D,QAASA,EACTmD,KAAK,UACLa,SAAS,SACTrC,UAAU,qBAER3B,EAAsCZ,EAASuB,OAAOsD,cAA5C7E,EAASuB,OAAOuD,aAIlC5C,EAAAC,EAAAC,cAAA,KAAGG,UAAU,mBAAb,8BAC6BL,EAAAC,EAAAC,cAAC2C,EAAA,EAAD,CAAMC,GAAG,gBAAgBhF,EAASuB,OAAO0D,aAO1E/C,EAAAC,EAAAC,cAAC8C,EAAA,EAAD,CAAOpC,MAAM,cAAc9B,QAASA,EAASmE,KA/GhC,SAAAlC,GAAK,IACZ5C,EAAkBN,EAAlBM,KAAMF,EAAYJ,EAAZI,QACd,IACEE,EAAK8C,eAAe,CAAC,OAAQ,UAAW,UAAW,UAAnD,eAAAiC,EAAA1E,OAAA2E,EAAA,EAAA3E,CAAA4E,EAAAnD,EAAAoD,KAA8D,SAAAC,EAAOpC,EAAKC,GAAZ,OAAAiC,EAAAnD,EAAAsD,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,WACxDxC,EADwD,CAAAsC,EAAAE,KAAA,eAAAF,EAAAG,OAAA,wBAI5DxC,EAAOyC,UAAY5G,EAAUmE,EAAO0C,SAASD,UAJeJ,EAAAE,KAAA,EAKtDI,YAAe3C,GALuC,OAM5DlD,EAAQ0B,KAAK,cACbZ,GAAW,GAPiD,wBAAAyE,EAAAO,SAAAT,MAA9D,gBAAAU,EAAAC,GAAA,OAAAf,EAAAgB,MAAAC,KAAAC,YAAA,IASA,MAAO5C,GAEPvD,EAAQ0B,KAAK,KACbZ,GAAW,KAgGkDsF,SA5F5C,SAAAtD,GAAK,IAChB9C,EAAYJ,EAAZI,QACRqB,IAAKgF,kBACLrG,EAAQ0B,KAAK,KACbZ,GAAW,KAyFPiB,EAAAC,EAAAC,cAAA,MAAII,MAAO,CAAEiE,UAAW,WAAazG,EAAS0G,QAAQC,oBACtDzE,EAAAC,EAAAC,cAACW,EAAA,EAAD,CAAMP,MAAO,CAAEoE,OAAQ,UAAYrE,UAAU,cAE3CL,EAAAC,EAAAC,cAACW,EAAA,EAAKvD,KAAN,KACGY,EAAkB,OAAQ,CACzBoE,aAAclE,EACdwD,MAAO,CACL,CACEE,UAAU,EACV1C,QAAS,6BALdlB,CAQE8B,EAAAC,EAAAC,cAAC6B,EAAA,EAAD,CAAOK,YAAatE,EAAS0G,QAAQpE,SAE1CJ,EAAAC,EAAAC,cAACW,EAAA,EAAKvD,KAAN,KACGY,EAAkB,UAAW,CAC5BoE,aAAclE,EACdwD,MAAO,CACL,CACEE,UAAU,EACV1C,QAAS,gCALdlB,CAQE8B,EAAAC,EAAAC,cAAC6B,EAAA,EAAD,CAAOK,YAAatE,EAAS0G,QAAQG,YAE1C3E,EAAAC,EAAAC,cAACW,EAAA,EAAKvD,KAAN,CAAWsH,aAAW,GACnB1G,EAAkB,UAAW,CAC5BoE,aAAclE,EACdwD,MAAO,CACL,CACEE,UAAU,EACV1C,QAAS,iCALdlB,CASC8B,EAAAC,EAAAC,cAAC2E,EAAA,EAAD,CACEC,YAAU,EACVC,iBAAiB,WACjBC,aAAc,SAACjD,EAAOkD,GAAR,OACZA,EAAOpH,MAAMqH,SAASC,cAAcC,QAAQrD,EAAMoD,gBAAkB,GAEtE/C,YAAatE,EAAS0G,QAAQX,SAE7BjE,KAIPI,EAAAC,EAAAC,cAACW,EAAA,EAAKvD,KAAN,KACGY,EAAkB,SAAU,CAC3BoE,aAAclE,EACdwD,MAAO,CACL,CACEE,UAAU,EACV1C,QAAS,uCALdlB,CAQE8B,EAAAC,EAAAC,cAAC6B,EAAA,EAAD,CAAOK,YAAatE,EAAS0G,QAAQa,iBAUrCC,cAAW5H,GChOX6H,sBAZf,SAAyBC,GACvB,MAAO,CACLC,SAAUD,EAAME,OAAOD,WAI3B,SAA4BE,GAC1B,MAAO,CACLC,QAASC,YAAmBC,EAAaH,KAI9BJ,CApCA,SAAA1H,GAAS,IAEpB4H,EAEE5H,EAFF4H,SACWM,EACTlI,EADF+H,QAAWG,UAOb,OACE/F,EAAAC,EAAAC,cAAA,OAAKG,UAAU,yDACbL,EAAAC,EAAAC,cAAA,WAASG,UAAU,WACjBL,EAAAC,EAAAC,cAAC8F,EAAA,EAAD,CAAWnE,KAAK,SAASxB,UAAU,cACjCL,EAAAC,EAAAC,cAAA,OAAKG,UAAU,OAAON,IAAI,KACvB,IACDC,EAAAC,EAAAC,cAAC+F,EAAD,CAAQjI,OAVH,SAAAmB,GACb4G,EAAU5G,IASsBsG,SAAUA,IAAa","file":"static/js/20.29c52b39.chunk.js","sourcesContent":["import React, { useState } from 'react';\nimport { Form, Icon, Input, Button, Checkbox, message, Modal, Select } from 'antd';\nimport { Link, withRouter } from 'react-router-dom';\nimport { injectIntl } from 'react-intl';\nimport { signin, setAuthToken, addBillingInfo } from './../../services';\nimport styled from 'styled-components';\n\nimport auth from './../../utils/auth';\nimport { config } from './../../config';\nimport './index.css';\n\nconst countries = require('./../../utils/countries').default;\n\nconst FormItem = styled(Form.Item)`\n  &.ant-form-inline .ant-form-item {\n    margin: 0 !important;\n  }\n`;\n\nconst Option = Select.Option;\n\nconst SignIn = props => {\n  const {\n    intl: { messages },\n    signIn,\n    history,\n    form: { getFieldDecorator },\n  } = props;\n  const formValues = {\n    name: '',\n    address: '',\n    country: 'ES',\n    vattax: '',\n  };\n  const [loading, setLoading] = useState(false);\n  const [visible, setVisible] = useState(false);\n\n  const handleReset = () => {\n    props.form.resetFields();\n  };\n\n  const success = response => {\n    const { accessToken } = response.data;\n\n    message.success(messages.signin.success);\n    auth.setToken(accessToken, true);\n    signIn(response.data);\n    setAuthToken(accessToken);\n    handleReset();\n    setLoading(false);\n\n    if (response.data && response.data.needBillingInformation) {\n      setVisible(true);\n    } else {\n      history.push('/dashboard');\n    }\n  };\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    props.form.validateFields(['email', 'password'], (err, values) => {\n      if (!err) {\n        const form = {\n          email: values.email,\n          password: values.password,\n        };\n        setLoading(true);\n\n        signin(form)\n          .then(response => {\n            success(response);\n          })\n          .catch(error => {\n            try {\n              if (error.response.status === 404) {\n                message.error(messages.signin.error.user);\n              } else if (error.response.status === 401) {\n                message.error(messages.signin.error.password);\n              } else {\n                message.error(messages.signin.error.all);\n              }\n            } catch (err) {\n              message.error(err.message);\n            }\n            setLoading(false);\n          });\n      }\n    });\n  };\n\n  const handleOk = e => {\n    const { form, history } = props;\n    try {\n      form.validateFields(['name', 'address', 'country', 'vattax'], async (err, values) => {\n        if (err) {\n          return;\n        }\n        values.continent = countries[values.country].continent;\n        await addBillingInfo(values);\n        history.push('/dashboard');\n        setVisible(false);\n      });\n    } catch (error) {\n      // auth.clearAppStorage();\n      history.push('/');\n      setVisible(false);\n    }\n  };\n\n  const handleCancel = e => {\n    const { history } = props;\n    auth.clearAppStorage();\n    history.push('/');\n    setVisible(false);\n  };\n\n  const options = Object.keys(countries).map(key => {\n    return (\n      <Option key={key} value={key}>\n        {countries[key].name}\n      </Option>\n    );\n  });\n\n  return (\n    <section className=\"form-card row no-gutters\">\n      <div\n        className=\"form-card__img form-card__img--left col-lg-5\"\n        style={{\n          backgroundImage: `url('${process.env.PUBLIC_URL}/images/bruno-martins-442125-unsplash.jpg')`,\n        }}\n      ></div>\n      <div className=\"form-card__body col-lg-7 p-lg-6 p-4\">\n        <section className=\"form-v1-container\">\n          <h2>Login to Continue</h2>\n          <p className=\"lead\">\n            Welcome back, sign in with your <strong>{config.pangeanic.title}</strong> account\n          </p>\n          <Form onSubmit={handleSubmit} className=\"form-v1\">\n            <FormItem>\n              {getFieldDecorator('email', {\n                rules: [\n                  {\n                    type: 'email',\n                    message: messages.signin.rules.email.type,\n                  },\n                  {\n                    required: true,\n                    message: messages.signin.rules.email.required,\n                  },\n                ],\n              })(\n                <Input\n                  size=\"large\"\n                  prefix={<Icon type=\"user\" style={{ fontSize: 13 }} />}\n                  placeholder=\"Email\"\n                />\n              )}\n            </FormItem>\n            <FormItem>\n              {getFieldDecorator('password', {\n                rules: [\n                  {\n                    required: true,\n                    message: messages.signin.rules.password.required,\n                  },\n                ],\n              })(\n                <Input\n                  size=\"large\"\n                  prefix={<Icon type=\"lock\" style={{ fontSize: 13 }} />}\n                  type=\"password\"\n                  placeholder={messages.signin.password}\n                />\n              )}\n            </FormItem>\n            <FormItem className=\"form-v1__remember\">\n              {getFieldDecorator('login1-remember', {\n                valuePropName: 'checked',\n                initialValue: true,\n              })(<Checkbox>{messages.signin.rememberMe}</Checkbox>)}\n            </FormItem>\n            <FormItem>\n              <Button\n                loading={loading}\n                type=\"primary\"\n                htmlType=\"submit\"\n                className=\"btn-cta btn-block\"\n              >\n                {!loading ? messages.signin.btnSignIn : messages.signin.btnSignInLoad}\n              </Button>\n            </FormItem>\n          </Form>\n          <p className=\"additional-info\">\n            Don't have an account yet? <Link to=\"/main/signup\">{messages.signin.register}</Link>\n          </p>\n          {/* <p className=\"additional-info\">\n            Forgot your username or password? <Link to=\"#\">Reset password</Link>\n          </p> */}\n        </section>\n      </div>\n      <Modal title=\"Basic Modal\" visible={visible} onOk={handleOk} onCancel={handleCancel}>\n        <h3 style={{ textAlign: 'center' }}>{messages.profile.billinginformation}</h3>\n        <Form style={{ margin: '0 auto' }} className=\"login-form\">\n          {/* nombre, dirección, pais, VAT/TAX number */}\n          <Form.Item>\n            {getFieldDecorator('name', {\n              initialValue: formValues.name,\n              rules: [\n                {\n                  required: true,\n                  message: 'Please input your Name!',\n                },\n              ],\n            })(<Input placeholder={messages.profile.name} />)}\n          </Form.Item>\n          <Form.Item>\n            {getFieldDecorator('address', {\n              initialValue: formValues.address,\n              rules: [\n                {\n                  required: true,\n                  message: 'Please input your Address!',\n                },\n              ],\n            })(<Input placeholder={messages.profile.address} />)}\n          </Form.Item>\n          <Form.Item hasFeedback>\n            {getFieldDecorator('country', {\n              initialValue: formValues.country,\n              rules: [\n                {\n                  required: true,\n                  message: 'Please select your country!',\n                },\n              ],\n            })(\n              <Select\n                showSearch\n                optionFilterProp=\"children\"\n                filterOption={(input, option) =>\n                  option.props.children.toLowerCase().indexOf(input.toLowerCase()) >= 0\n                }\n                placeholder={messages.profile.country}\n              >\n                {options}\n              </Select>\n            )}\n          </Form.Item>\n          <Form.Item>\n            {getFieldDecorator('vattax', {\n              initialValue: formValues.vattax,\n              rules: [\n                {\n                  required: true,\n                  message: 'Please input your VAT/TAX number!',\n                },\n              ],\n            })(<Input placeholder={messages.profile.vattax} />)}\n          </Form.Item>\n        </Form>\n      </Modal>\n    </section>\n  );\n};\n\nconst WrappedSignIn = Form.create()(injectIntl(SignIn));\n\nexport default withRouter(WrappedSignIn);\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport QueueAnim from 'rc-queue-anim';\nimport * as authActions from './../../reducers/auth';\n\nimport SignIn from './../../components/SignIn';\n\nconst Signin = props => {\n  const {\n    location,\n    authAct: { fetchAuth },\n  } = props;\n\n  const signIn = data => {\n    fetchAuth(data);\n  };\n\n  return (\n    <div className=\"container-fluid no-breadcrumb container-mw-lg chapter\">\n      <article className=\"article\">\n        <QueueAnim type=\"bottom\" className=\"ui-animate\">\n          <div className=\"mb-5\" key=\"1\">\n            {' '}\n            <SignIn signIn={signIn} location={location} />{' '}\n          </div>\n        </QueueAnim>\n      </article>\n    </div>\n  );\n};\n\nfunction mapStateToProps(state) {\n  return {\n    location: state.router.location,\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    authAct: bindActionCreators(authActions, dispatch),\n  };\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Signin);\n"],"sourceRoot":""}